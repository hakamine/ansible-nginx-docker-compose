---
version: '3'

volumes:

  nginx_web_root:
    external:
      name: "nginx-web-root"
  nginx_selfsigned:
    external:
      name: "nginx-selfsigned"


services:

    nginx:
      image: nginx:mainline-alpine
      container_name: nginx
      restart: unless-stopped
      ports:
        - "80:80"
        - "443:443"
      volumes:
        - {{ nginxdc_compose_cfg_dir }}/nginx/nginx.conf:/etc/nginx/nginx.conf:ro
        - {{ nginxdc_compose_cfg_dir }}/nginx/conf.d:/etc/nginx/conf.d:ro
        - nginx_web_root:/var/www/html
        - nginx_selfsigned:/etc/ssl/selfsigned

#   nginx:
#     image: nginx:mainline-alpine
#     container_name: nginx
#     restart: unless-stopped
#     ports:
#       - "80:80"
#     volumes:
#       - web-root:/var/www/html
#       - ./nginx-conf:/etc/nginx/conf.d
#       - certbot-etc:/etc/letsencrypt
#       - certbot-var:/var/lib/letsencrypt
#     depends_on:
#       - nodejs
#     networks:
#       - app-network

#   certbot:
#     image: certbot/certbot
#     container_name: certbot
#     volumes:
#       - certbot-etc:/etc/letsencrypt
#       - certbot-var:/var/lib/letsencrypt
#       - web-root:/var/www/html
#     depends_on:
#       - webserver
#     command: >
#         certonly --webroot 
#         --webroot-path=/var/www/html 
#         --email sammy@example.com 
#         --agree-tos 
#         --no-eff-email 
#         --staging 
#         -d example.com  -d www.example.com 